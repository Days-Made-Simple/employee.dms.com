<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Email Sign-In</title>
<style>
  *{box-sizing:border-box;margin:0;padding:0}
  html,body{height:100%}
  body{
    font-family: Inter, Roboto, -apple-system, "Segoe UI", "Helvetica Neue", Arial;
    background:#ffffff;
    color:#111827;
    -webkit-font-smoothing:antialiased;
    display:flex;
    align-items:center;
    justify-content:center;
    padding:24px;
  }

  .container{
    width:100%;
    max-width:420px;
    border-radius:12px;
    box-shadow:0 8px 30px rgba(17,24,39,0.06);
    overflow:hidden;
    background:#ffffff;
  }

  .header{
    padding:24px 28px;
    display:flex;
    align-items:center;
    gap:12px;
    border-bottom:1px solid rgba(15,23,42,0.04);
  }

  .logo{
    height:40px;
    width:40px;
    border-radius:6px;
    background:#eef2ff;
    display:flex;
    align-items:center;
    justify-content:center;
    font-weight:700;
    color:#4338ca;
    font-size:16px;
  }

  .brand{
    font-size:18px;
    font-weight:600;
  }

  .form{
    padding:28px;
    text-align:center;
  }

  p{
    font-size:14px;
    color:#374151;
    margin-bottom:20px;
  }

  .btn{
    background:#6366f1;
    color:#fff;
    padding:12px 20px;
    border-radius:10px;
    border:none;
    font-weight:600;
    cursor:pointer;
    margin:6px 0;
    width:100%;
  }
  .btn:hover{ background:#4f46e5; }

  .btn-secondary{
    background:#e5e7eb;
    color:#111827;
  }

  .footer{
    padding:12px 20px;
    border-top:1px solid rgba(15,23,42,0.04);
    font-size:12px;
    color:#6b7280;
    text-align:center;
  }
</style>
</head>
<body>
  <div class="container" role="main" aria-labelledby="emailSignInTitle">
    <div class="header">
      <div class="logo">ID</div>
      <div>
        <div class="brand">Days Made Simple Employee Portal</div>
        <div style="font-size:12px;color:#6b7280">Sign in using the link sent to your email</div>
      </div>
    </div>

    <div class="form">
      <p id="status">Verifying your sign-in link...</p>
      <button class="btn btn-secondary" onclick="goBack()">← Back to Sign-In</button>
    </div>

    <div class="footer">If you need help, contact your system administrator.</div>
  </div>

<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
<script>
  const firebaseConfig = {
    apiKey: "AIzaSyC6ReZ9JiKAhVwXLUwgzRRsk2Daw3pRli8",
    authDomain: "daysmadesimple-admin.firebaseapp.com",
    projectId: "daysmadesimple-admin",
    storageBucket: "daysmadesimple-admin.firebasestorage.app",
    messagingSenderId: "165327565681",
    appId: "1:165327565681:web:e28364ebb3cb1d9a683cd0"
  };
  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();

  const status = document.getElementById('status');

  if(auth.isSignInWithEmailLink(window.location.href)){
    let email = window.localStorage.getItem('emailForSignIn');
    if(!email) email = prompt('Enter your email to confirm sign-in');

 
const actionCodeSettings = {
     url: 'https://employees.daysmadesimple.com/public/emailsignin.html',
     handleCodeInApp: true
};
    auth.signInWithEmailLink(email, actionCodeSettings)
      .then(()=> {
        window.localStorage.removeItem('emailForSignIn');
        status.textContent = '✅ Sign-in successful! Redirecting...';
        setTimeout(()=> window.location.href='/dashboard',1500);
      })
      .catch(err=>{
        status.textContent = '❌ Sign-in failed: ' + err.message;
      });
  } else {
    status.textContent = '❌ Invalid sign-in link.';
  }

  function goBack(){ window.location.href='/'; }
</script>
</body>
</html>
